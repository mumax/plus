#include "demagasymptotic.hpp"

// Todo: Allow a user to chose an order and don't hardcode the orders?
//       This would need variable array sizes :(

/** Calculate the asymptotic solution of the demagkernel component Nxx up to
 *  order R⁻¹¹. This method is based on the method used in OOMMF.
 *  https://math.nist.gov/~MDonahue/talks/mmm2020-talk.pdf
 */
__host__ __device__ real calcAsymptoticNxx(int3 idx, real3 cellsize) {

  double hx = cellsize.x;
  double hy = cellsize.y;
  double hz = cellsize.z;
  double x = idx.x * hx;
  double y = idx.y * hy;
  double z = idx.z * hz;
  double R = sqrtf(x*x + y*y + z*z);
  
  double result = 0;
  
  // Order R⁻³
  result += 2./8. * pow(x,2) / (pow(R,5));
  result += -1./8. * pow(y,2) / (pow(R,5));
  result += -1./8. * pow(z,2) / (pow(R,5));

  // Order R⁻⁵
  result += 81./96. * pow(x,2)*pow(z,2)*pow(hz,2) / (pow(R,9));
  result += -12./96. * pow(x,4)*pow(hz,2) / (pow(R,9));
  result += -9./96. * pow(x,2)*pow(y,2)*pow(hz,2) / (pow(R,9));
  result += -9./96. * pow(y,2)*pow(z,2)*pow(hz,2) / (pow(R,9));
  result += 3./96. * pow(y,4)*pow(hz,2) / (pow(R,9));
  result += -12./96. * pow(z,4)*pow(hz,2) / (pow(R,9));
  result += 81./96. * pow(x,2)*pow(y,2)*pow(hy,2) / (pow(R,9));
  result += -12./96. * pow(x,4)*pow(hy,2) / (pow(R,9));
  result += -9./96. * pow(x,2)*pow(z,2)*pow(hy,2) / (pow(R,9));
  result += -12./96. * pow(y,4)*pow(hy,2) / (pow(R,9));
  result += -9./96. * pow(y,2)*pow(z,2)*pow(hy,2) / (pow(R,9));
  result += 3./96. * pow(z,4)*pow(hy,2) / (pow(R,9));
  result += 24./96. * pow(x,4)*pow(hx,2) / (pow(R,9));
  result += -72./96. * pow(x,2)*pow(y,2)*pow(hx,2) / (pow(R,9));
  result += -72./96. * pow(x,2)*pow(z,2)*pow(hx,2) / (pow(R,9));
  result += 9./96. * pow(y,4)*pow(hx,2) / (pow(R,9));
  result += 18./96. * pow(y,2)*pow(z,2)*pow(hx,2) / (pow(R,9));
  result += 9./96. * pow(z,4)*pow(hx,2) / (pow(R,9));

  // Order R⁻⁷
  result += 5220./2880. * pow(x,2)*pow(z,4)*pow(hz,4) / (pow(R,13));
  result += -4545./2880. * pow(x,4)*pow(z,2)*pow(hz,4) / (pow(R,13));
  result += -4050./2880. * pow(x,2)*pow(y,2)*pow(z,2)*pow(hz,4) / (pow(R,13));
  result += 270./2880. * pow(x,6)*pow(hz,4) / (pow(R,13));
  result += 495./2880. * pow(x,4)*pow(y,2)*pow(hz,4) / (pow(R,13));
  result += 180./2880. * pow(x,2)*pow(y,4)*pow(hz,4) / (pow(R,13));
  result += 180./2880. * pow(y,2)*pow(z,4)*pow(hz,4) / (pow(R,13));
  result += 495./2880. * pow(y,4)*pow(z,2)*pow(hz,4) / (pow(R,13));
  result += -45./2880. * pow(y,6)*pow(hz,4) / (pow(R,13));
  result += -360./2880. * pow(z,6)*pow(hz,4) / (pow(R,13));
  result += 8100./1152. * pow(x,2)*pow(y,2)*pow(z,2)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -675./1152. * pow(x,4)*pow(y,2)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -675./1152. * pow(x,2)*pow(y,4)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -675./1152. * pow(x,4)*pow(z,2)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += 90./1152. * pow(x,6)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -675./1152. * pow(x,2)*pow(z,4)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -675./1152. * pow(y,4)*pow(z,2)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += 90./1152. * pow(y,6)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -675./1152. * pow(y,2)*pow(z,4)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += 90./1152. * pow(z,6)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += 5220./2880. * pow(x,2)*pow(y,4)*pow(hy,4) / (pow(R,13));
  result += -4545./2880. * pow(x,4)*pow(y,2)*pow(hy,4) / (pow(R,13));
  result += -4050./2880. * pow(x,2)*pow(y,2)*pow(z,2)*pow(hy,4) / (pow(R,13));
  result += 270./2880. * pow(x,6)*pow(hy,4) / (pow(R,13));
  result += 495./2880. * pow(x,4)*pow(z,2)*pow(hy,4) / (pow(R,13));
  result += 180./2880. * pow(x,2)*pow(z,4)*pow(hy,4) / (pow(R,13));
  result += -360./2880. * pow(y,6)*pow(hy,4) / (pow(R,13));
  result += 180./2880. * pow(y,4)*pow(z,2)*pow(hy,4) / (pow(R,13));
  result += 495./2880. * pow(y,2)*pow(z,4)*pow(hy,4) / (pow(R,13));
  result += -45./2880. * pow(z,6)*pow(hy,4) / (pow(R,13));
  result += 5220./1152. * pow(x,4)*pow(z,2)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += -360./1152. * pow(x,6)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += 180./1152. * pow(x,4)*pow(y,2)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += -4050./1152. * pow(x,2)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += 495./1152. * pow(x,2)*pow(y,4)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += -4545./1152. * pow(x,2)*pow(z,4)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += 180./1152. * pow(y,4)*pow(z,2)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += -45./1152. * pow(y,6)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += 495./1152. * pow(y,2)*pow(z,4)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += 270./1152. * pow(z,6)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += 5220./1152. * pow(x,4)*pow(y,2)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += -360./1152. * pow(x,6)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += 180./1152. * pow(x,4)*pow(z,2)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += -4545./1152. * pow(x,2)*pow(y,4)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += -4050./1152. * pow(x,2)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += 495./1152. * pow(x,2)*pow(z,4)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += 270./1152. * pow(y,6)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += 495./1152. * pow(y,4)*pow(z,2)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += 180./1152. * pow(y,2)*pow(z,4)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += -45./1152. * pow(z,6)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += 720./2880. * pow(x,6)*pow(hx,4) / (pow(R,13));
  result += -5400./2880. * pow(x,4)*pow(y,2)*pow(hx,4) / (pow(R,13));
  result += -5400./2880. * pow(x,4)*pow(z,2)*pow(hx,4) / (pow(R,13));
  result += 4050./2880. * pow(x,2)*pow(y,4)*pow(hx,4) / (pow(R,13));
  result += 8100./2880. * pow(x,2)*pow(y,2)*pow(z,2)*pow(hx,4) / (pow(R,13));
  result += 4050./2880. * pow(x,2)*pow(z,4)*pow(hx,4) / (pow(R,13));
  result += -225./2880. * pow(y,6)*pow(hx,4) / (pow(R,13));
  result += -675./2880. * pow(y,4)*pow(z,2)*pow(hx,4) / (pow(R,13));
  result += -675./2880. * pow(y,2)*pow(z,4)*pow(hx,4) / (pow(R,13));
  result += -225./2880. * pow(z,6)*pow(hx,4) / (pow(R,13));

  // Order R⁻⁹
  result += 509040./161280. * pow(x,2)*pow(z,6)*pow(hz,6) / (pow(R,17));
  result += -1096200./161280. * pow(x,4)*pow(z,4)*pow(hz,6) / (pow(R,17));
  result += -1058400./161280. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hz,6) / (pow(R,17));
  result += 389025./161280. * pow(x,6)*pow(z,2)*pow(hz,6) / (pow(R,17));
  result += 741825./161280. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hz,6) / (pow(R,17));
  result += 316575./161280. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hz,6) / (pow(R,17));
  result += -12600./161280. * pow(x,8)*pow(hz,6) / (pow(R,17));
  result += -36225./161280. * pow(x,6)*pow(y,2)*pow(hz,6) / (pow(R,17));
  result += -33075./161280. * pow(x,4)*pow(y,4)*pow(hz,6) / (pow(R,17));
  result += -7875./161280. * pow(x,2)*pow(y,6)*pow(hz,6) / (pow(R,17));
  result += 55440./161280. * pow(y,2)*pow(z,6)*pow(hz,6) / (pow(R,17));
  result += 37800./161280. * pow(y,4)*pow(z,4)*pow(hz,6) / (pow(R,17));
  result += -36225./161280. * pow(y,6)*pow(z,2)*pow(hz,6) / (pow(R,17));
  result += 1575./161280. * pow(y,8)*pow(hz,6) / (pow(R,17));
  result += -20160./161280. * pow(z,8)*pow(hz,6) / (pow(R,17));
  result += 1200150./34560. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -600075./34560. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -600075./34560. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 21105./34560. * pow(x,6)*pow(y,2)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 47250./34560. * pow(x,4)*pow(y,4)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 21105./34560. * pow(x,2)*pow(y,6)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -23625./34560. * pow(x,4)*pow(z,4)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 49455./34560. * pow(x,6)*pow(z,2)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -2520./34560. * pow(x,8)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -70560./34560. * pow(x,2)*pow(z,6)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -23625./34560. * pow(y,4)*pow(z,4)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 49455./34560. * pow(y,6)*pow(z,2)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -2520./34560. * pow(y,8)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -70560./34560. * pow(y,2)*pow(z,6)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 5040./34560. * pow(z,8)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 1200150./34560. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -23625./34560. * pow(x,4)*pow(y,4)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -70560./34560. * pow(x,2)*pow(y,6)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -600075./34560. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 49455./34560. * pow(x,6)*pow(y,2)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -600075./34560. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 21105./34560. * pow(x,6)*pow(z,2)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -2520./34560. * pow(x,8)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 47250./34560. * pow(x,4)*pow(z,4)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 21105./34560. * pow(x,2)*pow(z,6)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -70560./34560. * pow(y,6)*pow(z,2)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 5040./34560. * pow(y,8)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -23625./34560. * pow(y,4)*pow(z,4)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 49455./34560. * pow(y,2)*pow(z,6)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -2520./34560. * pow(z,8)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 509040./161280. * pow(x,2)*pow(y,6)*pow(hy,6) / (pow(R,17));
  result += -1096200./161280. * pow(x,4)*pow(y,4)*pow(hy,6) / (pow(R,17));
  result += -1058400./161280. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hy,6) / (pow(R,17));
  result += 389025./161280. * pow(x,6)*pow(y,2)*pow(hy,6) / (pow(R,17));
  result += 741825./161280. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hy,6) / (pow(R,17));
  result += 316575./161280. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hy,6) / (pow(R,17));
  result += -12600./161280. * pow(x,8)*pow(hy,6) / (pow(R,17));
  result += -36225./161280. * pow(x,6)*pow(z,2)*pow(hy,6) / (pow(R,17));
  result += -33075./161280. * pow(x,4)*pow(z,4)*pow(hy,6) / (pow(R,17));
  result += -7875./161280. * pow(x,2)*pow(z,6)*pow(hy,6) / (pow(R,17));
  result += -20160./161280. * pow(y,8)*pow(hy,6) / (pow(R,17));
  result += 55440./161280. * pow(y,6)*pow(z,2)*pow(hy,6) / (pow(R,17));
  result += 37800./161280. * pow(y,4)*pow(z,4)*pow(hy,6) / (pow(R,17));
  result += -36225./161280. * pow(y,2)*pow(z,6)*pow(hy,6) / (pow(R,17));
  result += 1575./161280. * pow(z,8)*pow(hy,6) / (pow(R,17));
  result += 1119825./34560. * pow(x,4)*pow(z,4)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -438480./34560. * pow(x,6)*pow(z,2)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -141750./34560. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 15120./34560. * pow(x,8)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 15120./34560. * pow(x,6)*pow(y,2)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -14175./34560. * pow(x,4)*pow(y,4)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -141750./34560. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 283500./34560. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -13230./34560. * pow(x,2)*pow(y,6)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -438480./34560. * pow(x,2)*pow(z,6)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -14175./34560. * pow(y,4)*pow(z,4)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -13230./34560. * pow(y,6)*pow(z,2)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 945./34560. * pow(y,8)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 15120./34560. * pow(y,2)*pow(z,6)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 15120./34560. * pow(z,8)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 1200150./13824. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -70560./13824. * pow(x,6)*pow(y,2)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -23625./13824. * pow(x,4)*pow(y,4)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -70560./13824. * pow(x,6)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 5040./13824. * pow(x,8)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -23625./13824. * pow(x,4)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -600075./13824. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 49455./13824. * pow(x,2)*pow(y,6)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -600075./13824. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 49455./13824. * pow(x,2)*pow(z,6)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 21105./13824. * pow(y,6)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -2520./13824. * pow(y,8)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 47250./13824. * pow(y,4)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 21105./13824. * pow(y,2)*pow(z,6)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -2520./13824. * pow(z,8)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 1119825./34560. * pow(x,4)*pow(y,4)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -438480./34560. * pow(x,6)*pow(y,2)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -141750./34560. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 15120./34560. * pow(x,8)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 15120./34560. * pow(x,6)*pow(z,2)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -14175./34560. * pow(x,4)*pow(z,4)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -438480./34560. * pow(x,2)*pow(y,6)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -141750./34560. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 283500./34560. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -13230./34560. * pow(x,2)*pow(z,6)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 15120./34560. * pow(y,8)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 15120./34560. * pow(y,6)*pow(z,2)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -14175./34560. * pow(y,4)*pow(z,4)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -13230./34560. * pow(y,2)*pow(z,6)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 945./34560. * pow(z,8)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 509040./34560. * pow(x,6)*pow(z,2)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -20160./34560. * pow(x,8)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 55440./34560. * pow(x,6)*pow(y,2)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -1058400./34560. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 37800./34560. * pow(x,4)*pow(y,4)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -1096200./34560. * pow(x,4)*pow(z,4)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 316575./34560. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -36225./34560. * pow(x,2)*pow(y,6)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 741825./34560. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 389025./34560. * pow(x,2)*pow(z,6)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -7875./34560. * pow(y,6)*pow(z,2)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 1575./34560. * pow(y,8)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -33075./34560. * pow(y,4)*pow(z,4)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -36225./34560. * pow(y,2)*pow(z,6)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -12600./34560. * pow(z,8)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 509040./34560. * pow(x,6)*pow(y,2)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -20160./34560. * pow(x,8)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 55440./34560. * pow(x,6)*pow(z,2)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -1096200./34560. * pow(x,4)*pow(y,4)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -1058400./34560. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 37800./34560. * pow(x,4)*pow(z,4)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 389025./34560. * pow(x,2)*pow(y,6)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 741825./34560. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 316575./34560. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -36225./34560. * pow(x,2)*pow(z,6)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -12600./34560. * pow(y,8)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -36225./34560. * pow(y,6)*pow(z,2)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -33075./34560. * pow(y,4)*pow(z,4)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -7875./34560. * pow(y,2)*pow(z,6)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 1575./34560. * pow(z,8)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 40320./161280. * pow(x,8)*pow(hx,6) / (pow(R,17));
  result += -564480./161280. * pow(x,6)*pow(y,2)*pow(hx,6) / (pow(R,17));
  result += -564480./161280. * pow(x,6)*pow(z,2)*pow(hx,6) / (pow(R,17));
  result += 1058400./161280. * pow(x,4)*pow(y,4)*pow(hx,6) / (pow(R,17));
  result += 2116800./161280. * pow(x,4)*pow(y,2)*pow(z,2)*pow(hx,6) / (pow(R,17));
  result += 1058400./161280. * pow(x,4)*pow(z,4)*pow(hx,6) / (pow(R,17));
  result += -352800./161280. * pow(x,2)*pow(y,6)*pow(hx,6) / (pow(R,17));
  result += -1058400./161280. * pow(x,2)*pow(y,4)*pow(z,2)*pow(hx,6) / (pow(R,17));
  result += -1058400./161280. * pow(x,2)*pow(y,2)*pow(z,4)*pow(hx,6) / (pow(R,17));
  result += -352800./161280. * pow(x,2)*pow(z,6)*pow(hx,6) / (pow(R,17));
  result += 11025./161280. * pow(y,8)*pow(hx,6) / (pow(R,17));
  result += 44100./161280. * pow(y,6)*pow(z,2)*pow(hx,6) / (pow(R,17));
  result += 66150./161280. * pow(y,4)*pow(z,4)*pow(hx,6) / (pow(R,17));
  result += 44100./161280. * pow(y,2)*pow(z,6)*pow(hx,6) / (pow(R,17));
  result += 11025./161280. * pow(z,8)*pow(hx,6) / (pow(R,17));

  // Order 1/R⁻¹¹
  result += 70761600./14515200. * pow(x,2)*pow(z,8)*pow(hz,8) / (pow(R,21));
  result += -282592800./14515200. * pow(x,4)*pow(z,6)*pow(hz,8) / (pow(R,21));
  result += -285768000./14515200. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hz,8) / (pow(R,21));
  result += 250047000./14515200. * pow(x,6)*pow(z,4)*pow(hz,8) / (pow(R,21));
  result += 488187000./14515200. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hz,8) / (pow(R,21));
  result += 226233000./14515200. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hz,8) / (pow(R,21));
  result += -48521025./14515200. * pow(x,8)*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += -141693300./14515200. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += -133953750./14515200. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += -36911700./14515200. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += 992250./14515200. * pow(x,10)*pow(hz,8) / (pow(R,21));
  result += 3869775./14515200. * pow(x,8)*pow(y,2)*pow(hz,8) / (pow(R,21));
  result += 5556600./14515200. * pow(x,6)*pow(y,4)*pow(hz,8) / (pow(R,21));
  result += 3373650./14515200. * pow(x,4)*pow(y,6)*pow(hz,8) / (pow(R,21));
  result += 595350./14515200. * pow(x,2)*pow(y,8)*pow(hz,8) / (pow(R,21));
  result += 10886400./14515200. * pow(y,2)*pow(z,8)*pow(hz,8) / (pow(R,21));
  result += -3175200./14515200. * pow(y,4)*pow(z,6)*pow(hz,8) / (pow(R,21));
  result += -11907000./14515200. * pow(y,6)*pow(z,4)*pow(hz,8) / (pow(R,21));
  result += 3869775./14515200. * pow(y,8)*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += -99225./14515200. * pow(y,10)*pow(hz,8) / (pow(R,21));
  result += -1814400./14515200. * pow(z,10)*pow(hz,8) / (pow(R,21));
  result += 241712100./1935360. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -302140125./1935360. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -302140125./1935360. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 64893150./1935360. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 139907250./1935360. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 64893150./1935360. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -1318275./1935360. * pow(x,8)*pow(y,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -4663575./1935360. * pow(x,6)*pow(y,4)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -4663575./1935360. * pow(x,4)*pow(y,6)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -1318275./1935360. * pow(x,2)*pow(y,8)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 7342650./1935360. * pow(x,4)*pow(z,6)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 12800025./1935360. * pow(x,6)*pow(z,4)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -5060475./1935360. * pow(x,8)*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 141750./1935360. * pow(x,10)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -10206000./1935360. * pow(x,2)*pow(z,8)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 7342650./1935360. * pow(y,4)*pow(z,6)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 12800025./1935360. * pow(y,6)*pow(z,4)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -5060475./1935360. * pow(y,8)*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 141750./1935360. * pow(y,10)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -10206000./1935360. * pow(y,2)*pow(z,8)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 453600./1935360. * pow(z,10)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 372093750./1036800. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -69953625./1036800. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -120856050./1036800. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -396900./1036800. * pow(x,6)*pow(y,4)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 5060475./1036800. * pow(x,4)*pow(y,6)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 3231900./1036800. * pow(x,2)*pow(y,8)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -69953625./1036800. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 55962900./1036800. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -1913625./1036800. * pow(x,8)*pow(y,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -120856050./1036800. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -396900./1036800. * pow(x,6)*pow(z,4)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -1913625./1036800. * pow(x,8)*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 85050./1036800. * pow(x,10)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 5060475./1036800. * pow(x,4)*pow(z,6)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 3231900./1036800. * pow(x,2)*pow(z,8)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -12403125./1036800. * pow(y,6)*pow(z,4)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 6974100./1036800. * pow(y,8)*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -226800./1036800. * pow(y,10)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -12403125./1036800. * pow(y,4)*pow(z,6)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 6974100./1036800. * pow(y,2)*pow(z,8)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -226800./1036800. * pow(z,10)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 241712100./1935360. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 7342650./1935360. * pow(x,4)*pow(y,6)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -10206000./1935360. * pow(x,2)*pow(y,8)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -302140125./1935360. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 12800025./1935360. * pow(x,6)*pow(y,4)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -302140125./1935360. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 64893150./1935360. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -5060475./1935360. * pow(x,8)*pow(y,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 139907250./1935360. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 64893150./1935360. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -1318275./1935360. * pow(x,8)*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 141750./1935360. * pow(x,10)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -4663575./1935360. * pow(x,6)*pow(z,4)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -4663575./1935360. * pow(x,4)*pow(z,6)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -1318275./1935360. * pow(x,2)*pow(z,8)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -10206000./1935360. * pow(y,8)*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 453600./1935360. * pow(y,10)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 7342650./1935360. * pow(y,6)*pow(z,4)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 12800025./1935360. * pow(y,4)*pow(z,6)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -5060475./1935360. * pow(y,2)*pow(z,8)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 141750./1935360. * pow(z,10)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 70761600./14515200. * pow(x,2)*pow(y,8)*pow(hy,8) / (pow(R,21));
  result += -282592800./14515200. * pow(x,4)*pow(y,6)*pow(hy,8) / (pow(R,21));
  result += -285768000./14515200. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += 250047000./14515200. * pow(x,6)*pow(y,4)*pow(hy,8) / (pow(R,21));
  result += 488187000./14515200. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += 226233000./14515200. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hy,8) / (pow(R,21));
  result += -48521025./14515200. * pow(x,8)*pow(y,2)*pow(hy,8) / (pow(R,21));
  result += -141693300./14515200. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += -133953750./14515200. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hy,8) / (pow(R,21));
  result += -36911700./14515200. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hy,8) / (pow(R,21));
  result += 992250./14515200. * pow(x,10)*pow(hy,8) / (pow(R,21));
  result += 3869775./14515200. * pow(x,8)*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += 5556600./14515200. * pow(x,6)*pow(z,4)*pow(hy,8) / (pow(R,21));
  result += 3373650./14515200. * pow(x,4)*pow(z,6)*pow(hy,8) / (pow(R,21));
  result += 595350./14515200. * pow(x,2)*pow(z,8)*pow(hy,8) / (pow(R,21));
  result += -1814400./14515200. * pow(y,10)*pow(hy,8) / (pow(R,21));
  result += 10886400./14515200. * pow(y,8)*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += -3175200./14515200. * pow(y,6)*pow(z,4)*pow(hy,8) / (pow(R,21));
  result += -11907000./14515200. * pow(y,4)*pow(z,6)*pow(hy,8) / (pow(R,21));
  result += 3869775./14515200. * pow(y,2)*pow(z,8)*pow(hy,8) / (pow(R,21));
  result += -99225./14515200. * pow(z,10)*pow(hy,8) / (pow(R,21));
  result += 275250150./1935360. * pow(x,4)*pow(z,6)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -262847025./1935360. * pow(x,6)*pow(z,4)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -186046875./1935360. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 53581500./1935360. * pow(x,8)*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 76800150./1935360. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -5953500./1935360. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -1134000./1935360. * pow(x,10)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -2551500./1935360. * pow(x,8)*pow(y,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -893025./1935360. * pow(x,6)*pow(y,4)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 1289925./1935360. * pow(x,4)*pow(y,6)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 44055900./1935360. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 75907125./1935360. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -27981450./1935360. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 722925./1935360. * pow(x,2)*pow(y,8)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -60555600./1935360. * pow(x,2)*pow(z,8)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -4167450./1935360. * pow(y,4)*pow(z,6)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -893025./1935360. * pow(y,6)*pow(z,4)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 1190700./1935360. * pow(y,8)*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -42525./1935360. * pow(y,10)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -680400./1935360. * pow(y,2)*pow(z,8)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 1360800./1935360. * pow(z,10)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 372093750./414720. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -120856050./414720. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -69953625./414720. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 3231900./414720. * pow(x,8)*pow(y,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 5060475./414720. * pow(x,6)*pow(y,4)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -396900./414720. * pow(x,4)*pow(y,6)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -12403125./414720. * pow(x,6)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 6974100./414720. * pow(x,8)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -226800./414720. * pow(x,10)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -12403125./414720. * pow(x,4)*pow(z,6)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -69953625./414720. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 55962900./414720. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -1913625./414720. * pow(x,2)*pow(y,8)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -120856050./414720. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 6974100./414720. * pow(x,2)*pow(z,8)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -396900./414720. * pow(y,6)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -1913625./414720. * pow(y,8)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 85050./414720. * pow(y,10)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 5060475./414720. * pow(y,4)*pow(z,6)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 3231900./414720. * pow(y,2)*pow(z,8)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -226800./414720. * pow(z,10)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 372093750./414720. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -12403125./414720. * pow(x,6)*pow(y,4)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -12403125./414720. * pow(x,4)*pow(y,6)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -120856050./414720. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 6974100./414720. * pow(x,8)*pow(y,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -69953625./414720. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 3231900./414720. * pow(x,8)*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -226800./414720. * pow(x,10)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 5060475./414720. * pow(x,6)*pow(z,4)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -396900./414720. * pow(x,4)*pow(z,6)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -120856050./414720. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 6974100./414720. * pow(x,2)*pow(y,8)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -69953625./414720. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 55962900./414720. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -1913625./414720. * pow(x,2)*pow(z,8)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 3231900./414720. * pow(y,8)*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -226800./414720. * pow(y,10)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 5060475./414720. * pow(y,6)*pow(z,4)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -396900./414720. * pow(y,4)*pow(z,6)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -1913625./414720. * pow(y,2)*pow(z,8)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 85050./414720. * pow(z,10)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 275250150./1935360. * pow(x,4)*pow(y,6)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -262847025./1935360. * pow(x,6)*pow(y,4)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -186046875./1935360. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 53581500./1935360. * pow(x,8)*pow(y,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 76800150./1935360. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -5953500./1935360. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -1134000./1935360. * pow(x,10)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -2551500./1935360. * pow(x,8)*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -893025./1935360. * pow(x,6)*pow(z,4)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 1289925./1935360. * pow(x,4)*pow(z,6)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -60555600./1935360. * pow(x,2)*pow(y,8)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 44055900./1935360. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 75907125./1935360. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -27981450./1935360. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 722925./1935360. * pow(x,2)*pow(z,8)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 1360800./1935360. * pow(y,10)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -680400./1935360. * pow(y,8)*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -4167450./1935360. * pow(y,6)*pow(z,4)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -893025./1935360. * pow(y,4)*pow(z,6)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 1190700./1935360. * pow(y,2)*pow(z,8)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -42525./1935360. * pow(z,10)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 275250150./1036800. * pow(x,6)*pow(z,4)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -60555600./1036800. * pow(x,8)*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 44055900./1036800. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 1360800./1036800. * pow(x,10)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -680400./1036800. * pow(x,8)*pow(y,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -4167450./1036800. * pow(x,6)*pow(y,4)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -186046875./1036800. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 75907125./1036800. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -893025./1036800. * pow(x,4)*pow(y,6)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -262847025./1036800. * pow(x,4)*pow(z,6)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -5953500./1036800. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -27981450./1036800. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 1190700./1036800. * pow(x,2)*pow(y,8)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 76800150./1036800. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 53581500./1036800. * pow(x,2)*pow(z,8)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 1289925./1036800. * pow(y,6)*pow(z,4)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 722925./1036800. * pow(y,8)*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -42525./1036800. * pow(y,10)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -893025./1036800. * pow(y,4)*pow(z,6)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -2551500./1036800. * pow(y,2)*pow(z,8)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -1134000./1036800. * pow(z,10)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 241712100./414720. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -10206000./414720. * pow(x,8)*pow(y,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 7342650./414720. * pow(x,6)*pow(y,4)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -10206000./414720. * pow(x,8)*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 453600./414720. * pow(x,10)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 7342650./414720. * pow(x,6)*pow(z,4)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -302140125./414720. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 12800025./414720. * pow(x,4)*pow(y,6)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -302140125./414720. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 12800025./414720. * pow(x,4)*pow(z,6)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 64893150./414720. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -5060475./414720. * pow(x,2)*pow(y,8)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 139907250./414720. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 64893150./414720. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -5060475./414720. * pow(x,2)*pow(z,8)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -1318275./414720. * pow(y,8)*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 141750./414720. * pow(y,10)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -4663575./414720. * pow(y,6)*pow(z,4)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -4663575./414720. * pow(y,4)*pow(z,6)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -1318275./414720. * pow(y,2)*pow(z,8)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 141750./414720. * pow(z,10)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 275250150./1036800. * pow(x,6)*pow(y,4)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -60555600./1036800. * pow(x,8)*pow(y,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 44055900./1036800. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 1360800./1036800. * pow(x,10)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -680400./1036800. * pow(x,8)*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -4167450./1036800. * pow(x,6)*pow(z,4)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -262847025./1036800. * pow(x,4)*pow(y,6)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -186046875./1036800. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 75907125./1036800. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -893025./1036800. * pow(x,4)*pow(z,6)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 53581500./1036800. * pow(x,2)*pow(y,8)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 76800150./1036800. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -5953500./1036800. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -27981450./1036800. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 1190700./1036800. * pow(x,2)*pow(z,8)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -1134000./1036800. * pow(y,10)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -2551500./1036800. * pow(y,8)*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -893025./1036800. * pow(y,6)*pow(z,4)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 1289925./1036800. * pow(y,4)*pow(z,6)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 722925./1036800. * pow(y,2)*pow(z,8)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -42525./1036800. * pow(z,10)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 70761600./1935360. * pow(x,8)*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -1814400./1935360. * pow(x,10)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 10886400./1935360. * pow(x,8)*pow(y,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -285768000./1935360. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -3175200./1935360. * pow(x,6)*pow(y,4)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -282592800./1935360. * pow(x,6)*pow(z,4)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 226233000./1935360. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -11907000./1935360. * pow(x,4)*pow(y,6)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 488187000./1935360. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 250047000./1935360. * pow(x,4)*pow(z,6)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -36911700./1935360. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 3869775./1935360. * pow(x,2)*pow(y,8)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -133953750./1935360. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -141693300./1935360. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -48521025./1935360. * pow(x,2)*pow(z,8)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 595350./1935360. * pow(y,8)*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -99225./1935360. * pow(y,10)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 3373650./1935360. * pow(y,6)*pow(z,4)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 5556600./1935360. * pow(y,4)*pow(z,6)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 3869775./1935360. * pow(y,2)*pow(z,8)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 992250./1935360. * pow(z,10)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 70761600./1935360. * pow(x,8)*pow(y,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -1814400./1935360. * pow(x,10)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 10886400./1935360. * pow(x,8)*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -282592800./1935360. * pow(x,6)*pow(y,4)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -285768000./1935360. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -3175200./1935360. * pow(x,6)*pow(z,4)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 250047000./1935360. * pow(x,4)*pow(y,6)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 488187000./1935360. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 226233000./1935360. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -11907000./1935360. * pow(x,4)*pow(z,6)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -48521025./1935360. * pow(x,2)*pow(y,8)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -141693300./1935360. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -133953750./1935360. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -36911700./1935360. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 3869775./1935360. * pow(x,2)*pow(z,8)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 992250./1935360. * pow(y,10)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 3869775./1935360. * pow(y,8)*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 5556600./1935360. * pow(y,6)*pow(z,4)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 3373650./1935360. * pow(y,4)*pow(z,6)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 595350./1935360. * pow(y,2)*pow(z,8)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -99225./1935360. * pow(z,10)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 3628800./14515200. * pow(x,10)*pow(hx,8) / (pow(R,21));
  result += -81648000./14515200. * pow(x,8)*pow(y,2)*pow(hx,8) / (pow(R,21));
  result += -81648000./14515200. * pow(x,8)*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += 285768000./14515200. * pow(x,6)*pow(y,4)*pow(hx,8) / (pow(R,21));
  result += 571536000./14515200. * pow(x,6)*pow(y,2)*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += 285768000./14515200. * pow(x,6)*pow(z,4)*pow(hx,8) / (pow(R,21));
  result += -238140000./14515200. * pow(x,4)*pow(y,6)*pow(hx,8) / (pow(R,21));
  result += -714420000./14515200. * pow(x,4)*pow(y,4)*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += -714420000./14515200. * pow(x,4)*pow(y,2)*pow(z,4)*pow(hx,8) / (pow(R,21));
  result += -238140000./14515200. * pow(x,4)*pow(z,6)*pow(hx,8) / (pow(R,21));
  result += 44651250./14515200. * pow(x,2)*pow(y,8)*pow(hx,8) / (pow(R,21));
  result += 178605000./14515200. * pow(x,2)*pow(y,6)*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += 267907500./14515200. * pow(x,2)*pow(y,4)*pow(z,4)*pow(hx,8) / (pow(R,21));
  result += 178605000./14515200. * pow(x,2)*pow(y,2)*pow(z,6)*pow(hx,8) / (pow(R,21));
  result += 44651250./14515200. * pow(x,2)*pow(z,8)*pow(hx,8) / (pow(R,21));
  result += -893025./14515200. * pow(y,10)*pow(hx,8) / (pow(R,21));
  result += -4465125./14515200. * pow(y,8)*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += -8930250./14515200. * pow(y,6)*pow(z,4)*pow(hx,8) / (pow(R,21));
  result += -8930250./14515200. * pow(y,4)*pow(z,6)*pow(hx,8) / (pow(R,21));
  result += -4465125./14515200. * pow(y,2)*pow(z,8)*pow(hx,8) / (pow(R,21));
  result += -893025./14515200. * pow(z,10)*pow(hx,8) / (pow(R,21));

  // multiply with prefactor
  result *= 8 * cellsize.x * cellsize.y * cellsize.z;
  result /= -4*M_PI;

  return result;
}

/** Calculate the asymptotic solution of the demagkernel component Nxy up to
 *  order R⁻¹¹. This method is based on the method used in OOMMF.
 *  https://math.nist.gov/~MDonahue/talks/mmm2020-talk.pdf
 */
__host__ __device__ real calcAsymptoticNxy(int3 idx, real3 cellsize) {

  double hx = cellsize.x;
  double hy = cellsize.y;
  double hz = cellsize.z;
  double x = idx.x * hx;
  double y = idx.y * hy;
  double z = idx.z * hz;
  float R = sqrtf(x*x + y*y + z*z);
  
  double result = 0;

  // Order 1/R³
  result += 3./8. * x*y / (pow(R,5));

  // Order R⁻⁵
  result += 90./96. * x*y*pow(z,2)*pow(hz,2) / (pow(R,9));
  result += -15./96. * pow(x,3)*y*pow(hz,2) / (pow(R,9));
  result += -15./96. * x*pow(y,3)*pow(hz,2) / (pow(R,9));
  result += 60./96. * x*pow(y,3)*pow(hy,2) / (pow(R,9));
  result += -45./96. * pow(x,3)*y*pow(hy,2) / (pow(R,9));
  result += -45./96. * x*y*pow(z,2)*pow(hy,2) / (pow(R,9));
  result += 60./96. * pow(x,3)*y*pow(hx,2) / (pow(R,9));
  result += -45./96. * x*pow(y,3)*pow(hx,2) / (pow(R,9));
  result += -45./96. * x*y*pow(z,2)*pow(hx,2) / (pow(R,9));

  // Order R⁻⁷
  result += 5040./2880. * x*y*pow(z,4)*pow(hz,4) / (pow(R,13));
  result += -5040./2880. * pow(x,3)*y*pow(z,2)*pow(hz,4) / (pow(R,13));
  result += -5040./2880. * x*pow(y,3)*pow(z,2)*pow(hz,4) / (pow(R,13));
  result += 315./2880. * pow(x,5)*y*pow(hz,4) / (pow(R,13));
  result += 630./2880. * pow(x,3)*pow(y,3)*pow(hz,4) / (pow(R,13));
  result += 315./2880. * x*pow(y,5)*pow(hz,4) / (pow(R,13));
  result += 7245./1152. * x*pow(y,3)*pow(z,2)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -315./1152. * pow(x,3)*pow(y,3)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -630./1152. * x*pow(y,5)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -2205./1152. * pow(x,3)*y*pow(z,2)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += 315./1152. * pow(x,5)*y*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += -2520./1152. * x*y*pow(z,4)*pow(hy,2)*pow(hz,2) / (pow(R,13));
  result += 2520./2880. * x*pow(y,5)*pow(hy,4) / (pow(R,13));
  result += -6300./2880. * pow(x,3)*pow(y,3)*pow(hy,4) / (pow(R,13));
  result += -6300./2880. * x*pow(y,3)*pow(z,2)*pow(hy,4) / (pow(R,13));
  result += 1575./2880. * pow(x,5)*y*pow(hy,4) / (pow(R,13));
  result += 3150./2880. * pow(x,3)*y*pow(z,2)*pow(hy,4) / (pow(R,13));
  result += 1575./2880. * x*y*pow(z,4)*pow(hy,4) / (pow(R,13));
  result += 7245./1152. * pow(x,3)*y*pow(z,2)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += -630./1152. * pow(x,5)*y*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += -315./1152. * pow(x,3)*pow(y,3)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += -2205./1152. * x*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += 315./1152. * x*pow(y,5)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += -2520./1152. * x*y*pow(z,4)*pow(hx,2)*pow(hz,2) / (pow(R,13));
  result += 6615./1152. * pow(x,3)*pow(y,3)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += -1890./1152. * pow(x,5)*y*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += -945./1152. * pow(x,3)*y*pow(z,2)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += -1890./1152. * x*pow(y,5)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += -945./1152. * x*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += 945./1152. * x*y*pow(z,4)*pow(hx,2)*pow(hy,2) / (pow(R,13));
  result += 2520./2880. * pow(x,5)*y*pow(hx,4) / (pow(R,13));
  result += -6300./2880. * pow(x,3)*pow(y,3)*pow(hx,4) / (pow(R,13));
  result += -6300./2880. * pow(x,3)*y*pow(z,2)*pow(hx,4) / (pow(R,13));
  result += 1575./2880. * x*pow(y,5)*pow(hx,4) / (pow(R,13));
  result += 3150./2880. * x*pow(y,3)*pow(z,2)*pow(hx,4) / (pow(R,13));
  result += 1575./2880. * x*y*pow(z,4)*pow(hx,4) / (pow(R,13));

  // Order R⁻⁹
  result += 453600./161280. * x*y*pow(z,6)*pow(hz,6) / (pow(R,17));
  result += -1134000./161280. * pow(x,3)*y*pow(z,4)*pow(hz,6) / (pow(R,17));
  result += -1134000./161280. * x*pow(y,3)*pow(z,4)*pow(hz,6) / (pow(R,17));
  result += 425250./161280. * pow(x,5)*y*pow(z,2)*pow(hz,6) / (pow(R,17));
  result += 850500./161280. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hz,6) / (pow(R,17));
  result += 425250./161280. * x*pow(y,5)*pow(z,2)*pow(hz,6) / (pow(R,17));
  result += -14175./161280. * pow(x,7)*y*pow(hz,6) / (pow(R,17));
  result += -42525./161280. * pow(x,5)*pow(y,3)*pow(hz,6) / (pow(R,17));
  result += -42525./161280. * pow(x,3)*pow(y,5)*pow(hz,6) / (pow(R,17));
  result += -14175./161280. * x*pow(y,7)*pow(hz,6) / (pow(R,17));
  result += 1190700./34560. * x*pow(y,3)*pow(z,4)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -425250./34560. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -586845./34560. * x*pow(y,5)*pow(z,2)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 5670./34560. * pow(x,5)*pow(y,3)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 36855./34560. * pow(x,3)*pow(y,5)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 22680./34560. * x*pow(y,7)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -56700./34560. * pow(x,3)*y*pow(z,4)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 161595./34560. * pow(x,5)*y*pow(z,2)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -8505./34560. * pow(x,7)*y*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += -226800./34560. * x*y*pow(z,6)*pow(hy,2)*pow(hz,4) / (pow(R,17));
  result += 861840./34560. * x*pow(y,5)*pow(z,2)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 30240./34560. * pow(x,3)*pow(y,5)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -45360./34560. * x*pow(y,7)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -916650./34560. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 61425./34560. * pow(x,5)*pow(y,3)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -978075./34560. * x*pow(y,3)*pow(z,4)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 113400./34560. * pow(x,5)*y*pow(z,2)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += -14175./34560. * pow(x,7)*y*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 269325./34560. * pow(x,3)*y*pow(z,4)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 141750./34560. * x*y*pow(z,6)*pow(hy,4)*pow(hz,2) / (pow(R,17));
  result += 181440./161280. * x*pow(y,7)*pow(hy,6) / (pow(R,17));
  result += -952560./161280. * pow(x,3)*pow(y,5)*pow(hy,6) / (pow(R,17));
  result += -952560./161280. * x*pow(y,5)*pow(z,2)*pow(hy,6) / (pow(R,17));
  result += 793800./161280. * pow(x,5)*pow(y,3)*pow(hy,6) / (pow(R,17));
  result += 1341900./161280. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hy,6) / (pow(R,17));
  result += 1039500./161280. * x*pow(y,3)*pow(z,4)*pow(hy,6) / (pow(R,17));
  result += -99225./161280. * pow(x,7)*y*pow(hy,6) / (pow(R,17));
  result += -259875./161280. * pow(x,5)*y*pow(z,2)*pow(hy,6) / (pow(R,17));
  result += -297675./161280. * pow(x,3)*y*pow(z,4)*pow(hy,6) / (pow(R,17));
  result += -137025./161280. * x*y*pow(z,6)*pow(hy,6) / (pow(R,17));
  result += 1190700./34560. * pow(x,3)*y*pow(z,4)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -586845./34560. * pow(x,5)*y*pow(z,2)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -425250./34560. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 22680./34560. * pow(x,7)*y*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 36855./34560. * pow(x,5)*pow(y,3)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 5670./34560. * pow(x,3)*pow(y,5)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -56700./34560. * x*pow(y,3)*pow(z,4)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 161595./34560. * x*pow(y,5)*pow(z,2)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -8505./34560. * x*pow(y,7)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += -226800./34560. * x*y*pow(z,6)*pow(hx,2)*pow(hz,4) / (pow(R,17));
  result += 1341900./13824. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -67095./13824. * pow(x,5)*pow(y,3)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -67095./13824. * pow(x,3)*pow(y,5)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -274995./13824. * pow(x,5)*y*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 22680./13824. * pow(x,7)*y*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -212625./13824. * pow(x,3)*y*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -274995./13824. * x*pow(y,5)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 22680./13824. * x*pow(y,7)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += -212625./13824. * x*pow(y,3)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 85050./13824. * x*y*pow(z,6)*pow(hx,2)*pow(hy,2)*pow(hz,2) / (pow(R,17));
  result += 922320./34560. * pow(x,3)*pow(y,5)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -855225./34560. * pow(x,5)*pow(y,3)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -670950./34560. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 113400./34560. * pow(x,7)*y*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 184275./34560. * pow(x,5)*y*pow(z,2)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 28350./34560. * pow(x,3)*y*pow(z,4)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -136080./34560. * x*pow(y,7)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 90720./34560. * x*pow(y,5)*pow(z,2)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 184275./34560. * x*pow(y,3)*pow(z,4)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += -42525./34560. * x*y*pow(z,6)*pow(hx,2)*pow(hy,4) / (pow(R,17));
  result += 861840./34560. * pow(x,5)*y*pow(z,2)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -45360./34560. * pow(x,7)*y*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 30240./34560. * pow(x,5)*pow(y,3)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -916650./34560. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 61425./34560. * pow(x,3)*pow(y,5)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -978075./34560. * pow(x,3)*y*pow(z,4)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 113400./34560. * x*pow(y,5)*pow(z,2)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += -14175./34560. * x*pow(y,7)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 269325./34560. * x*pow(y,3)*pow(z,4)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 141750./34560. * x*y*pow(z,6)*pow(hx,4)*pow(hz,2) / (pow(R,17));
  result += 922320./34560. * pow(x,5)*pow(y,3)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -136080./34560. * pow(x,7)*y*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 90720./34560. * pow(x,5)*y*pow(z,2)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -855225./34560. * pow(x,3)*pow(y,5)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -670950./34560. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 184275./34560. * pow(x,3)*y*pow(z,4)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 113400./34560. * x*pow(y,7)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 184275./34560. * x*pow(y,5)*pow(z,2)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 28350./34560. * x*pow(y,3)*pow(z,4)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += -42525./34560. * x*y*pow(z,6)*pow(hx,4)*pow(hy,2) / (pow(R,17));
  result += 181440./161280. * pow(x,7)*y*pow(hx,6) / (pow(R,17));
  result += -952560./161280. * pow(x,5)*pow(y,3)*pow(hx,6) / (pow(R,17));
  result += -952560./161280. * pow(x,5)*y*pow(z,2)*pow(hx,6) / (pow(R,17));
  result += 793800./161280. * pow(x,3)*pow(y,5)*pow(hx,6) / (pow(R,17));
  result += 1341900./161280. * pow(x,3)*pow(y,3)*pow(z,2)*pow(hx,6) / (pow(R,17));
  result += 1039500./161280. * pow(x,3)*y*pow(z,4)*pow(hx,6) / (pow(R,17));
  result += -99225./161280. * x*pow(y,7)*pow(hx,6) / (pow(R,17));
  result += -259875./161280. * x*pow(y,5)*pow(z,2)*pow(hx,6) / (pow(R,17));
  result += -297675./161280. * x*pow(y,3)*pow(z,4)*pow(hx,6) / (pow(R,17));
  result += -137025./161280. * x*y*pow(z,6)*pow(hx,6) / (pow(R,17));

  // Order 1/R⁻¹¹
  result += 59875200./14515200. * x*y*pow(z,8)*pow(hz,8) / (pow(R,21));
  result += -279417600./14515200. * pow(x,3)*y*pow(z,6)*pow(hz,8) / (pow(R,21));
  result += -279417600./14515200. * x*pow(y,3)*pow(z,6)*pow(hz,8) / (pow(R,21));
  result += 261954000./14515200. * pow(x,5)*y*pow(z,4)*pow(hz,8) / (pow(R,21));
  result += 523908000./14515200. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hz,8) / (pow(R,21));
  result += 261954000./14515200. * x*pow(y,5)*pow(z,4)*pow(hz,8) / (pow(R,21));
  result += -52390800./14515200. * pow(x,7)*y*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += -157172400./14515200. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += -157172400./14515200. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += -52390800./14515200. * x*pow(y,7)*pow(z,2)*pow(hz,8) / (pow(R,21));
  result += 1091475./14515200. * pow(x,9)*y*pow(hz,8) / (pow(R,21));
  result += 4365900./14515200. * pow(x,7)*pow(y,3)*pow(hz,8) / (pow(R,21));
  result += 6548850./14515200. * pow(x,5)*pow(y,5)*pow(hz,8) / (pow(R,21));
  result += 4365900./14515200. * pow(x,3)*pow(y,7)*pow(hz,8) / (pow(R,21));
  result += 1091475./14515200. * x*pow(y,9)*pow(hz,8) / (pow(R,21));
  result += 253222200./1935360. * x*pow(y,3)*pow(z,6)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -261954000./1935360. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -301247100./1935360. * x*pow(y,5)*pow(z,4)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 36018675./1935360. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 121153725./1935360. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 68762925./1935360. * x*pow(y,7)*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -155925./1935360. * pow(x,7)*pow(y,3)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -3274425./1935360. * pow(x,5)*pow(y,5)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -4209975./1935360. * pow(x,3)*pow(y,7)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -1559250./1935360. * x*pow(y,9)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 26195400./1935360. * pow(x,3)*y*pow(z,6)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 39293100./1935360. * pow(x,5)*y*pow(z,4)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -16372125./1935360. * pow(x,7)*y*pow(z,2)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 467775./1935360. * pow(x,9)*y*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += -29937600./1935360. * x*y*pow(z,8)*pow(hy,2)*pow(hz,6) / (pow(R,21));
  result += 337265775./1036800. * x*pow(y,5)*pow(z,4)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -6548850./1036800. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -95426100./1036800. * x*pow(y,7)*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -3274425./1036800. * pow(x,5)*pow(y,5)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 1871100./1036800. * pow(x,3)*pow(y,7)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 2494800./1036800. * x*pow(y,9)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -120062250./1036800. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 78586200./1036800. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -2182950./1036800. * pow(x,7)*pow(y,3)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -200831400./1036800. * x*pow(y,3)*pow(z,6)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -3274425./1036800. * pow(x,5)*y*pow(z,4)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += -10291050./1036800. * pow(x,7)*y*pow(z,2)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 467775./1036800. * pow(x,9)*y*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 26195400./1036800. * pow(x,3)*y*pow(z,6)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 18711000./1036800. * x*y*pow(z,8)*pow(hy,4)*pow(hz,4) / (pow(R,21));
  result += 145152000./1935360. * x*pow(y,7)*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 11982600./1935360. * pow(x,3)*pow(y,7)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -4989600./1935360. * x*pow(y,9)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -301644000./1935360. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 5641650./1935360. * pow(x,5)*pow(y,5)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -366820650./1935360. * x*pow(y,5)*pow(z,4)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 160588575./1935360. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -10163475./1935360. * pow(x,7)*pow(y,3)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 218139075./1935360. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 211250025./1935360. * x*pow(y,3)*pow(z,6)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -12885075./1935360. * pow(x,7)*y*pow(z,2)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 1167075./1935360. * pow(x,9)*y*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -28080675./1935360. * pow(x,5)*y*pow(z,4)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -32115825./1935360. * pow(x,3)*y*pow(z,6)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += -18087300./1935360. * x*y*pow(z,8)*pow(hy,6)*pow(hz,2) / (pow(R,21));
  result += 19958400./14515200. * x*pow(y,9)*pow(hy,8) / (pow(R,21));
  result += -179625600./14515200. * pow(x,3)*pow(y,7)*pow(hy,8) / (pow(R,21));
  result += -179625600./14515200. * x*pow(y,7)*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += 314344800./14515200. * pow(x,5)*pow(y,5)*pow(hy,8) / (pow(R,21));
  result += 577092600./14515200. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += 365941800./14515200. * x*pow(y,5)*pow(z,4)*pow(hy,8) / (pow(R,21));
  result += -130977000./14515200. * pow(x,7)*pow(y,3)*pow(hy,8) / (pow(R,21));
  result += -356359500./14515200. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += -392931000./14515200. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hy,8) / (pow(R,21));
  result += -167548500./14515200. * x*pow(y,3)*pow(z,6)*pow(hy,8) / (pow(R,21));
  result += 9823275./14515200. * pow(x,9)*y*pow(hy,8) / (pow(R,21));
  result += 35891100./14515200. * pow(x,7)*y*pow(z,2)*pow(hy,8) / (pow(R,21));
  result += 55537650./14515200. * pow(x,5)*y*pow(z,4)*pow(hy,8) / (pow(R,21));
  result += 42695100./14515200. * pow(x,3)*y*pow(z,6)*pow(hy,8) / (pow(R,21));
  result += 13225275./14515200. * x*y*pow(z,8)*pow(hy,8) / (pow(R,21));
  result += 253222200./1935360. * pow(x,3)*y*pow(z,6)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -301247100./1935360. * pow(x,5)*y*pow(z,4)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -261954000./1935360. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 68762925./1935360. * pow(x,7)*y*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 121153725./1935360. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 36018675./1935360. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -1559250./1935360. * pow(x,9)*y*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -4209975./1935360. * pow(x,7)*pow(y,3)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -3274425./1935360. * pow(x,5)*pow(y,5)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -155925./1935360. * pow(x,3)*pow(y,7)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 26195400./1935360. * x*pow(y,3)*pow(z,6)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 39293100./1935360. * x*pow(y,5)*pow(z,4)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -16372125./1935360. * x*pow(y,7)*pow(z,2)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 467775./1935360. * x*pow(y,9)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += -29937600./1935360. * x*y*pow(z,8)*pow(hx,2)*pow(hz,6) / (pow(R,21));
  result += 382016250./414720. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -114604875./414720. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -114604875./414720. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 2338875./414720. * pow(x,7)*pow(y,3)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 6548850./414720. * pow(x,5)*pow(y,5)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 2338875./414720. * pow(x,3)*pow(y,7)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -36018675./414720. * pow(x,5)*y*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 26663175./414720. * pow(x,7)*y*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -935550./414720. * pow(x,9)*y*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -52390800./414720. * pow(x,3)*y*pow(z,6)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -36018675./414720. * x*pow(y,5)*pow(z,4)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 26663175./414720. * x*pow(y,7)*pow(z,2)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -935550./414720. * x*pow(y,9)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += -52390800./414720. * x*pow(y,3)*pow(z,6)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 11226600./414720. * x*y*pow(z,8)*pow(hx,2)*pow(hy,2)*pow(hz,4) / (pow(R,21));
  result += 333991350./414720. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -3274425./414720. * pow(x,5)*pow(y,5)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -14345100./414720. * pow(x,3)*pow(y,7)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -219386475./414720. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 12006225./414720. * pow(x,7)*pow(y,3)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -191008125./414720. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 20114325./414720. * pow(x,7)*y*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -1559250./414720. * pow(x,9)*y*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 39293100./414720. * pow(x,5)*y*pow(z,4)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 12006225./414720. * pow(x,3)*y*pow(z,6)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -46777500./414720. * x*pow(y,7)*pow(z,2)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 2494800./414720. * x*pow(y,9)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -3274425./414720. * x*pow(y,5)*pow(z,4)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 40384575./414720. * x*pow(y,3)*pow(z,6)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += -5613300./414720. * x*y*pow(z,8)*pow(hx,2)*pow(hy,4)*pow(hz,2) / (pow(R,21));
  result += 167151600./1935360. * pow(x,3)*pow(y,7)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -320893650./1935360. * pow(x,5)*pow(y,5)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -301247100./1935360. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 140800275./1935360. * pow(x,7)*pow(y,3)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 252130725./1935360. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 81860625./1935360. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -10914750./1935360. * pow(x,9)*y*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -29469825./1935360. * pow(x,7)*y*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -22920975./1935360. * pow(x,5)*y*pow(z,4)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -1091475./1935360. * pow(x,3)*y*pow(z,6)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -14968800./1935360. * x*pow(y,9)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 37422000./1935360. * x*pow(y,7)*pow(z,2)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 19646550./1935360. * x*pow(y,5)*pow(z,4)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += -29469825./1935360. * x*pow(y,3)*pow(z,6)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 3274425./1935360. * x*y*pow(z,8)*pow(hx,2)*pow(hy,6) / (pow(R,21));
  result += 337265775./1036800. * pow(x,5)*y*pow(z,4)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -95426100./1036800. * pow(x,7)*y*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -6548850./1036800. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 2494800./1036800. * pow(x,9)*y*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 1871100./1036800. * pow(x,7)*pow(y,3)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -3274425./1036800. * pow(x,5)*pow(y,5)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -120062250./1036800. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 78586200./1036800. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -2182950./1036800. * pow(x,3)*pow(y,7)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -200831400./1036800. * pow(x,3)*y*pow(z,6)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -3274425./1036800. * x*pow(y,5)*pow(z,4)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += -10291050./1036800. * x*pow(y,7)*pow(z,2)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 467775./1036800. * x*pow(y,9)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 26195400./1036800. * x*pow(y,3)*pow(z,6)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 18711000./1036800. * x*y*pow(z,8)*pow(hx,4)*pow(hz,4) / (pow(R,21));
  result += 333991350./414720. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -14345100./414720. * pow(x,7)*pow(y,3)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -3274425./414720. * pow(x,5)*pow(y,5)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -46777500./414720. * pow(x,7)*y*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 2494800./414720. * pow(x,9)*y*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -3274425./414720. * pow(x,5)*y*pow(z,4)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -219386475./414720. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 12006225./414720. * pow(x,3)*pow(y,7)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -191008125./414720. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 40384575./414720. * pow(x,3)*y*pow(z,6)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 20114325./414720. * x*pow(y,7)*pow(z,2)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -1559250./414720. * x*pow(y,9)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 39293100./414720. * x*pow(y,5)*pow(z,4)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 12006225./414720. * x*pow(y,3)*pow(z,6)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += -5613300./414720. * x*y*pow(z,8)*pow(hx,4)*pow(hy,2)*pow(hz,2) / (pow(R,21));
  result += 324168075./1036800. * pow(x,5)*pow(y,5)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -152806500./1036800. * pow(x,7)*pow(y,3)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -32744250./1036800. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 12474000./1036800. * pow(x,9)*y*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 9355500./1036800. * pow(x,7)*y*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -16372125./1036800. * pow(x,5)*y*pow(z,4)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -152806500./1036800. * pow(x,3)*pow(y,7)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -32744250./1036800. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 109147500./1036800. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -10914750./1036800. * pow(x,3)*y*pow(z,6)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 12474000./1036800. * x*pow(y,9)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 9355500./1036800. * x*pow(y,7)*pow(z,2)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -16372125./1036800. * x*pow(y,5)*pow(z,4)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += -10914750./1036800. * x*pow(y,3)*pow(z,6)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 2338875./1036800. * x*y*pow(z,8)*pow(hx,4)*pow(hy,4) / (pow(R,21));
  result += 145152000./1935360. * pow(x,7)*y*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -4989600./1935360. * pow(x,9)*y*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 11982600./1935360. * pow(x,7)*pow(y,3)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -301644000./1935360. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 5641650./1935360. * pow(x,5)*pow(y,5)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -366820650./1935360. * pow(x,5)*y*pow(z,4)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 160588575./1935360. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -10163475./1935360. * pow(x,3)*pow(y,7)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 218139075./1935360. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 211250025./1935360. * pow(x,3)*y*pow(z,6)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -12885075./1935360. * x*pow(y,7)*pow(z,2)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 1167075./1935360. * x*pow(y,9)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -28080675./1935360. * x*pow(y,5)*pow(z,4)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -32115825./1935360. * x*pow(y,3)*pow(z,6)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += -18087300./1935360. * x*y*pow(z,8)*pow(hx,6)*pow(hz,2) / (pow(R,21));
  result += 167151600./1935360. * pow(x,7)*pow(y,3)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -14968800./1935360. * pow(x,9)*y*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 35947800./1935360. * pow(x,7)*y*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -320893650./1935360. * pow(x,5)*pow(y,5)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -274201200./1935360. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 4167450./1935360. * pow(x,5)*y*pow(z,4)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 140800275./1935360. * pow(x,3)*pow(y,7)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 194977125./1935360. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 176492925./1935360. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -41546925./1935360. * pow(x,3)*y*pow(z,6)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -10914750./1935360. * x*pow(y,9)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -23573025./1935360. * x*pow(y,7)*pow(z,2)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -28477575./1935360. * x*pow(y,5)*pow(z,4)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += -10617075./1935360. * x*pow(y,3)*pow(z,6)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 5202225./1935360. * x*y*pow(z,8)*pow(hx,6)*pow(hy,2) / (pow(R,21));
  result += 19958400./14515200. * pow(x,9)*y*pow(hx,8) / (pow(R,21));
  result += -179625600./14515200. * pow(x,7)*pow(y,3)*pow(hx,8) / (pow(R,21));
  result += -179625600./14515200. * pow(x,7)*y*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += 314344800./14515200. * pow(x,5)*pow(y,5)*pow(hx,8) / (pow(R,21));
  result += 577092600./14515200. * pow(x,5)*pow(y,3)*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += 365941800./14515200. * pow(x,5)*y*pow(z,4)*pow(hx,8) / (pow(R,21));
  result += -130977000./14515200. * pow(x,3)*pow(y,7)*pow(hx,8) / (pow(R,21));
  result += -356359500./14515200. * pow(x,3)*pow(y,5)*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += -392931000./14515200. * pow(x,3)*pow(y,3)*pow(z,4)*pow(hx,8) / (pow(R,21));
  result += -167548500./14515200. * pow(x,3)*y*pow(z,6)*pow(hx,8) / (pow(R,21));
  result += 9823275./14515200. * x*pow(y,9)*pow(hx,8) / (pow(R,21));
  result += 35891100./14515200. * x*pow(y,7)*pow(z,2)*pow(hx,8) / (pow(R,21));
  result += 55537650./14515200. * x*pow(y,5)*pow(z,4)*pow(hx,8) / (pow(R,21));
  result += 42695100./14515200. * x*pow(y,3)*pow(z,6)*pow(hx,8) / (pow(R,21));
  result += 13225275./14515200. * x*y*pow(z,8)*pow(hx,8) / (pow(R,21));

  // multiply with prefactor
  result *= 8 * cellsize.x * cellsize.y * cellsize.z;
  result /= -4*M_PI;
  
  return result;
}

// reuse Nxx and Nxy by permutating the arguments to implement the other kernel
// components
real calcAsymptoticNyy(int3 idx, real3 cs) {
  return calcAsymptoticNxx({idx.y, idx.z, idx.x}, {cs.y, cs.z, cs.x});
}
real calcAsymptoticNzz(int3 idx, real3 cs) {
  return calcAsymptoticNxx({idx.z, idx.x, idx.y}, {cs.z, cs.x, cs.y});
}
real calcAsymptoticNxz(int3 idx, real3 cs) {
  return calcAsymptoticNxy({idx.x, idx.z, idx.y}, {cs.x, cs.z, cs.y});
}
real calcAsymptoticNyx(int3 idx, real3 cs) {
  return calcAsymptoticNxy({idx.y, idx.x, idx.z}, {cs.y, cs.x, cs.z});
}
real calcAsymptoticNyz(int3 idx, real3 cs) {
  return calcAsymptoticNxy({idx.y, idx.z, idx.x}, {cs.y, cs.z, cs.x});
}
real calcAsymptoticNzx(int3 idx, real3 cs) {
  return calcAsymptoticNxy({idx.z, idx.x, idx.y}, {cs.z, cs.x, cs.y});
}
real calcAsymptoticNzy(int3 idx, real3 cs) {
  return calcAsymptoticNxy({idx.z, idx.y, idx.x}, {cs.z, cs.y, cs.x});
}
